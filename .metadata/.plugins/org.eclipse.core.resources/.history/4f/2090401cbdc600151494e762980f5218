package OpenEJA.ORM;

import java.lang.annotation.Annotation;
import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.util.HashMap;

import OpenEJA.Annotation.AutoGenerated;
import OpenEJA.Annotation.Column;
import OpenEJA.Annotation.Id;
import OpenEJA.Annotation.Table;
import OpenEJA.DAL.DBAdapter;
import OpenEJA.DAL.DBFactoryAdapter;

public abstract class Entity implements IEntity {
	
	private final String name;	
	private final DBAdapter dba;

	
	public Entity(String name){
		this.name = name;
		this.dba = DBFactoryAdapter.getDBAdapter();		
	}
	@Override
	public void add(){
			
		Class<?> entityClass = this.getClass();
		Table tableAnnotation = (Table)entityClass.getAnnotation(Table.class);
		String tableName = "";
		tableName = tableAnnotation.name();		
		System.out.println("Table Name : " + tableName);
		Field[] fields = entityClass.getFields();	
		boolean isAnnotationColumn;
		
		HashMap<String, String> newData = new HashMap<String, String>();
		
		for(Field field : fields){
			try {
				System.out.println(field.getName() + ":" + field.get(this).toString());
		
				isAnnotationColumn = field.isAnnotationPresent(Column.class);
				if(isAnnotationColumn){
					Column columnAnnotation = (Column)field.getAnnotation(Column.class);
					newData.put(columnAnnotation.name(), field.get(this).toString());
				}				
				System.out.println("Column :" + isAnnotationColumn);
				
			} catch (Throwable ex) {
				System.err.println(ex);
			}			
		}
		
	}
	
	@Override
	public void remove(){
		//parse the annotation and add	
			
		
	}
	
	@Override
	public void update(){
		//parse the annotation and add	
		
	}
	public void print()
	{
		System.out.println(name);
	}

	

}
